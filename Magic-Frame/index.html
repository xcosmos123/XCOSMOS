<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Magic AR Frame - Xcosmos</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>

    <style>
      body { margin: 0; overflow: hidden; }
      
      /* Start Button */
      #start-button {
        position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%);
        padding: 10px 20px; background: #ff0055; color: white; border: none;
        border-radius: 5px; font-size: 16px; z-index: 999; display: none; cursor: pointer;
      }

      /* Debug/Status Box */
      #status-log {
        position: absolute; top: 10px; left: 10px; z-index: 1000;
        background: rgba(0, 0, 0, 0.7); color: lime; 
        font-family: monospace; font-size: 12px; padding: 10px;
        border-radius: 5px; pointer-events: none;
        max-width: 80%; word-wrap: break-word;
      }

      /* Loading Screen */
      #loading-screen {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        background: black; color: white; display: flex;
        justify-content: center; align-items: center; z-index: 998;
        flex-direction: column; text-align: center;
      }
    </style>
  </head>
  <body>
    
    <!-- Status Log for Debugging -->
    <div id="status-log">System Initializing...</div>

    <div id="loading-screen">
      <div>Loading AR System...</div>
    </div>
    
    <button id="start-button">üîä Start Magic</button>

    <!-- 
      ‡¥∂‡µç‡¥∞‡¥¶‡µç‡¥ß‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï (IMPORTANT):
      ‡¥á‡¥µ‡¥ø‡¥ü‡µÜ ‡¥á‡¥™‡µç‡¥™‡µã‡µæ ‡¥µ‡µº‡¥ï‡µç‡¥ï‡µç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡¥æ‡µª ‡¥∏‡¥æ‡¥Æ‡µç‡¥™‡¥ø‡µæ ‡¥≤‡¥ø‡¥ô‡µç‡¥ï‡µç ‡¥Ü‡¥£‡µç. 
      GitHub-‡µΩ ‡¥á‡¥ü‡µÅ‡¥Æ‡µç‡¥™‡µã‡µæ ‡¥§‡¥æ‡¥¥‡µÜ ‡¥ï‡¥æ‡¥£‡µÅ‡¥®‡µç‡¥® ‡¥≤‡¥ø‡¥ô‡µç‡¥ï‡µç ‡¥Æ‡¥æ‡¥±‡µç‡¥±‡¥ø './targets.mind' ‡¥é‡¥®‡µç‡¥®‡µç ‡¥ï‡µä‡¥ü‡µÅ‡¥ï‡µç‡¥ï‡µÅ‡¥ï.
      REPLACE LINK BELOW WITH: ./targets.mind
    -->
    <a-scene 
      mindar-image="imageTargetSrc: https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.2.5/examples/image-tracking/assets/card-example/card.mind; filterMinCF:0.0001; filterBeta: 0.001;" 
      color-space="sRGB" 
      renderer="colorManagement: true, physicallyCorrectLights" 
      vr-mode-ui="enabled: false" 
      device-orientation-permission-ui="enabled: false">

      <a-assets>
        <!-- 
           ‡¥∂‡µç‡¥∞‡¥¶‡µç‡¥ß‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï (IMPORTANT):
           GitHub-‡µΩ ‡¥á‡¥ü‡µÅ‡¥Æ‡µç‡¥™‡µã‡µæ ‡¥§‡¥æ‡¥¥‡µÜ ‡¥ï‡¥æ‡¥£‡µÅ‡¥®‡µç‡¥® ‡¥≤‡¥ø‡¥ô‡µç‡¥ï‡µç ‡¥Æ‡¥æ‡¥±‡µç‡¥±‡¥ø './video.mp4' ‡¥é‡¥®‡µç‡¥®‡µç ‡¥ï‡µä‡¥ü‡µÅ‡¥ï‡µç‡¥ï‡µÅ‡¥ï.
           REPLACE SRC BELOW WITH: ./video.mp4
        -->
        <video 
          id="ar-video" 
          preload="auto" 
          loop 
          crossorigin="anonymous" 
          playsinline 
          webkit-playsinline>
          <source src="https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.2.5/examples/image-tracking/assets/card-example/portfolio/portfolio.mp4" type="video/mp4">
        </video>
      </a-assets>

      <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

      <a-entity mindar-image-target="targetIndex: 0">
        <a-video src="#ar-video" position="0 0 0" height="0.552" width="1" rotation="0 0 0"></a-video>
      </a-entity>
    </a-scene>

    <script>
      const startButton = document.getElementById('start-button');
      const loadingScreen = document.getElementById('loading-screen');
      const statusLog = document.getElementById('status-log');
      const video = document.getElementById('ar-video');
      const sceneEl = document.querySelector('a-scene');

      function log(msg) {
        console.log(msg);
        statusLog.innerHTML += "<br>" + msg;
      }

      // 1. AR System Ready
      sceneEl.addEventListener("arReady", (event) => {
        log("‚úÖ AR System Ready.");
        log("üëâ Click 'Start Magic' button.");
        loadingScreen.style.display = "none"; 
        startButton.style.display = "block";  
      });
      
      // 2. AR Loading Error
      sceneEl.addEventListener("arError", (event) => {
        log("‚ùå Error: targets.mind not found!");
        loadingScreen.innerHTML = "<div style='color:red'>FAILED: Check file path</div>";
      });

      // 3. Video Loading Check
      video.addEventListener("loadeddata", () => {
        log("‚úÖ Video loaded successfully.");
      });

      video.addEventListener("error", (e) => {
        log("‚ùå Error: video file not found!");
      });

      // 4. Button Click
      startButton.addEventListener('click', () => {
        log("üîä Audio Enabled. Scanning...");
        video.muted = false;
        video.play().then(() => {
            video.pause(); 
            video.currentTime = 0;
            startButton.style.display = 'none';
        }).catch(e => {
            log("‚ö†Ô∏è Play error: " + e.message);
        });
      });

      // 5. Target Found
      const arEntity = document.querySelector('[mindar-image-target]');
      arEntity.addEventListener("targetFound", event => {
        log("üéØ PHOTO FOUND! Playing video...");
        video.play().catch(e => log("‚ùå Play Blocked: " + e.message));
      });

      // 6. Target Lost
      arEntity.addEventListener("targetLost", event => {
        log("‚úã Photo Lost. Pausing...");
        video.pause();
      });
    </script>
  </body>
</html>
